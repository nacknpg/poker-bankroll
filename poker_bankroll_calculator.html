
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Poker Bankroll Calculator</title>
  <style>
    :root{
      --bg:#0f172a;
      --panel:#111827;
      --muted:#94a3b8;
      --text:#e5e7eb;
      --accent:#22d3ee;
      --accent2:#a78bfa;
      --danger:#f87171;
      --ok:#34d399;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(1200px 600px at 70% -20%, rgba(34,211,238,.12), transparent 60%),
                  radial-gradient(800px 400px at -30% 10%, rgba(167,139,250,.1), transparent 60%), var(--bg);
      color:var(--text);
      line-height:1.6;
    }
    header{
      padding:28px 20px 10px;
      text-align:center;
    }
    h1{
      font-size: clamp(24px, 2.3vw, 34px);
      margin:0 0 6px;
      letter-spacing:.4px;
    }
    .subtitle{color:var(--muted); font-size:14px}
    .container{max-width:1050px; margin:20px auto 60px; padding:0 16px}
    .grid{
      display:grid;
      grid-template-columns: 1.2fr 1fr;
      gap:18px;
    }
    @media (max-width: 900px){
      .grid{grid-template-columns:1fr}
    }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent),
                  rgba(17,24,39,.75);
      backdrop-filter: blur(6px);
      border:1px solid rgba(255,255,255,.06);
      border-radius:14px;
      padding:18px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    .section-title{
      font-weight:700;
      font-size:14px;
      letter-spacing:.6px;
      text-transform:uppercase;
      color:#cbd5e1;
      margin:0 0 12px;
      display:flex; align-items:center; gap:8px;
    }
    .section-title span.badge{font-size:11px; padding:2px 8px; border:1px solid rgba(255,255,255,.12); border-radius:999px; color:var(--muted)}
    label{display:block; font-size:13px; color:#cbd5e1; margin-bottom:6px}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    .row-3{display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px}
    .input, select{
      width:100%;
      background:#0b1220;
      color:var(--text);
      border:1px solid rgba(255,255,255,.12);
      border-radius:10px;
      padding:10px 12px;
      font-size:15px;
      outline:none;
      transition:.15s border;
    }
    .input:focus, select:focus{border-color:var(--accent)}
    .help{color:var(--muted); font-size:12px; margin-top:4px}
    .btn{
      background:linear-gradient(90deg,var(--accent), var(--accent2));
      color:#0b1220;
      font-weight:700;
      border:none; border-radius:12px;
      padding:12px 16px;
      cursor:pointer;
      width:100%;
      margin-top:8px;
      font-size:15px;
    }
    .btn.secondary{
      background:transparent;
      color:var(--text);
      border:1px solid rgba(255,255,255,.16);
    }
    .result{
      font-size:15px;
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
    }
    .pill{
      display:flex; justify-content:space-between; align-items:center;
      padding:10px 12px;
      border:1px dashed rgba(255,255,255,.2);
      border-radius:12px;
    }
    .pill strong{font-size:16px}
    .ok{color:var(--ok)}
    .warn{color:var(--danger)}
    .muted{color:var(--muted)}
    .footnote{font-size:12px; color:var(--muted)}
    .tabs{display:flex; gap:8px; margin-bottom:12px}
    .tab{
      flex:1; text-align:center; padding:10px 12px; border-radius:10px;
      border:1px solid rgba(255,255,255,.12);
      cursor:pointer; font-weight:700; font-size:14px; color:#cbd5e1;
    }
    .tab.active{border-color:var(--accent); color:var(--text); background:rgba(34,211,238,.08)}
    .hidden{display:none}
    .mini{font-size:12px}
    .quote{
      margin-top:10px;
      border-left:3px solid rgba(34,211,238,.35);
      padding:8px 12px;
      font-size:13px;
      color:#cbd5e1;
      background: rgba(34,211,238,.05);
      border-radius:8px;
    }
  </style>
</head>
<body>
  <header>
    <h1>Poker Bankroll Calculator</h1>
    <div class="subtitle">คำนวณแบงค์โรลสำหรับ Cash Game, SNG และ MTT — ปรับความเสี่ยงได้</div>
  </header>

  <div class="container grid">
    <section class="card">
      <div class="tabs">
        <div class="tab active" data-tab="cash">Cash Game</div>
        <div class="tab" data-tab="sng">Sit & Go</div>
        <div class="tab" data-tab="mtt">MTT (ทัวร์นาเมนต์)</div>
      </div>

      <!-- CASH GAME -->
      <div id="cash" class="panel">
        <h3 class="section-title">Cash Game <span class="badge">Risk of Ruin Model</span></h3>
        <div class="row">
          <div>
            <label>Winrate (bb / 100 hands)</label>
            <input id="cash_wr" type="number" class="input" value="5" step="0.1" />
            <div class="help">ค่าเฉลี่ยผู้ชนะทั่วไปอยู่ราว 3–8 bb/100</div>
          </div>
          <div>
            <label>ส่วนเบี่ยงเบนมาตรฐาน (σ, bb / 100 hands)</label>
            <input id="cash_sd100" type="number" class="input" value="90" step="1" />
            <div class="help">ถ้าไม่ทราบ ให้ใช้ 80–100 bb/100 เป็นค่าเริ่มต้น</div>
          </div>
        </div>
        <div class="row">
          <div>
            <label>กำหนดโอกาสล้มละลาย (Risk of Ruin)</label>
            <select id="cash_ror" class="input">
              <option value="0.10">10% (Aggressive)</option>
              <option value="0.05" selected>5% (มาตรฐาน)</option>
              <option value="0.02">2%</option>
              <option value="0.01">1% (Conservative)</option>
              <option value="0.001">0.1% (Very Safe)</option>
            </select>
          </div>
          <div>
            <label>ขนาดบลายด์ (เช่น 10/20 ใส่ 20)</label>
            <input id="cash_bbsize" type="number" class="input" value="20" step="1" />
            <div class="help">ใช้ค่า Big Blind (฿)</div>
          </div>
        </div>
        <button class="btn" id="calc_cash">คำนวณ Cash BR</button>
        <div class="quote mini">สูตรประมาณ: BR_bb = - (σ_hand² / (2 * wr_hand)) * ln(ROR),
          โดย wr_hand = (bb/100)/100 และ σ_hand = σ_100 / 10</div>
      </div>

      <!-- SNG -->
      <div id="sng" class="panel hidden">
        <h3 class="section-title">Sit & Go <span class="badge">Heuristic + Risk Level</span></h3>
        <div class="row-3">
          <div>
            <label>Average Buy-in (ABI)</label>
            <input id="sng_abi" type="number" class="input" value="200" step="1"/>
          </div>
          <div>
            <label>ROI คาดหวัง (%)</label>
            <input id="sng_roi" type="number" class="input" value="8" step="1"/>
          </div>
          <div>
            <label>ระดับความเสี่ยง</label>
            <select id="sng_risk" class="input">
              <option value="0.7">Aggressive</option>
              <option value="1" selected>Standard</option>
              <option value="1.4">Conservative</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div>
            <label>รูปแบบ (6-max / 9-max / Hyper ฯลฯ)</label>
            <select id="sng_type" class="input">
              <option value="80">Turbo/Hyper</option>
              <option value="100" selected>มาตรฐาน</option>
              <option value="120">โครงสร้างช้า</option>
            </select>
            <div class="help">ค่าพื้นฐาน (จำนวน ABI) ก่อนปรับ</div>
          </div>
          <div>
            <label>ค่าเงิน (฿ ต่อ 1 buy-in)</label>
            <input id="sng_ccy" type="number" class="input" value="1" step="0.01"/>
          </div>
        </div>
        <button class="btn" id="calc_sng">คำนวณ SNG BR</button>
        <div class="quote mini">หลักง่ายๆ SNG ใช้ 80–120 × ABI แล้วปรับตาม ROI และความเสี่ยง</div>
      </div>

      <!-- MTT -->
      <div id="mtt" class="panel hidden">
        <h3 class="section-title">MTT (ทัวร์นาเมนต์) <span class="badge">Heuristic by Field Size</span></h3>
        <div class="row-3">
          <div>
            <label>Average Buy-in (ABI)</label>
            <input id="mtt_abi" type="number" class="input" value="500" step="1"/>
          </div>
          <div>
            <label>ROI คาดหวัง (%)</label>
            <input id="mtt_roi" type="number" class="input" value="20" step="1"/>
          </div>
          <div>
            <label>ระดับความเสี่ยง</label>
            <select id="mtt_risk" class="input">
              <option value="0.6">Aggressive</option>
              <option value="1" selected>Standard</option>
              <option value="1.5">Conservative</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div>
            <label>ขนาดฟิลด์โดยเฉลี่ย (players/ทัวร์)</label>
            <select id="mtt_field" class="input">
              <option value="120">เล็ก (&lt; 200)</option>
              <option value="200" selected>กลาง (200–1,000)</option>
              <option value="300">ใหญ่ (&gt; 1,000)</option>
            </select>
            <div class="help">ค่าพื้นฐานเป็นจำนวน ABI</div>
          </div>
          <div>
            <label>ค่าเงิน (฿ ต่อ 1 buy-in)</label>
            <input id="mtt_ccy" type="number" class="input" value="1" step="0.01"/>
          </div>
        </div>
        <button class="btn" id="calc_mtt">คำนวณ MTT BR</button>
        <div class="quote mini">แนวปฏิบัติ: เล็ก ~120×, กลาง ~200×, ใหญ่ ~300× ของ ABI แล้วปรับตาม ROI/ความเสี่ยง</div>
      </div>
    </section>

    <section class="card">
      <h3 class="section-title">ผลลัพธ์</h3>
      <div class="result" id="result">
        <div class="pill"><span>แบงค์โรลที่แนะนำ</span><strong id="r_bankroll">—</strong></div>
        <div class="pill"><span>หน่วย</span><strong id="r_unit">—</strong></div>
        <div class="pill"><span>รองรับขีดจำกัด</span><strong id="r_limit">—</strong></div>
        <div class="pill"><span>ระดับความปลอดภัย</span><strong id="r_safety">—</strong></div>
      </div>
      <div class="quote" id="explain">เลือกโหมดด้านซ้าย ใส่ค่าพื้นฐาน แล้วกดคำนวณ</div>
      <div class="footnote" style="margin-top:12px">
        หมายเหตุ: แบบจำลองเป็นเชิงประมาณ เพื่อช่วยตัดสินใจเบื้องต้น
        ความแปรปรวนของจริงขึ้นกับสไตล์การเล่น, ฟิลด์, โครงสร้างบลายด์, rake และ mental game
      </div>
      <button class="btn secondary" id="reset">รีเซ็ต</button>
    </section>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);
    const tabs = document.querySelectorAll('.tab');
    const panels = document.querySelectorAll('.panel');
    tabs.forEach(t=>t.addEventListener('click', ()=>{
      tabs.forEach(x=>x.classList.remove('active'));
      panels.forEach(p=>p.classList.add('hidden'));
      t.classList.add('active');
      document.getElementById(t.dataset.tab).classList.remove('hidden');
      clearResult();
    }));

    function formatTHB(x){
      if(!isFinite(x)) return '—';
      return x.toLocaleString('th-TH', {maximumFractionDigits:0});
    }
    function clearResult(){
      $('r_bankroll').textContent='—';
      $('r_unit').textContent='—';
      $('r_limit').textContent='—';
      $('r_safety').textContent='—';
      $('explain').textContent='';
    }

    // CASH
    $('calc_cash').addEventListener('click', ()=>{
      const wr100 = parseFloat($('cash_wr').value);     // bb per 100
      const sd100 = parseFloat($('cash_sd100').value);  // bb per 100
      const ror   = parseFloat($('cash_ror').value);    // probability
      const bbsize= parseFloat($('cash_bbsize').value); // currency per BB
      if(wr100<=0 || sd100<=0 || ror<=0 || bbsize<=0){ alert('กรุณาใส่ค่ามากกว่า 0'); return; }

      const wr_hand = wr100/100.0;
      const sd_hand = sd100/10.0;  // since sd per hand ≈ sd100 / 10
      const var_hand = sd_hand*sd_hand;
      const bankroll_bb = - (var_hand / (2*wr_hand)) * Math.log(ror);
      const bankroll_ccy = bankroll_bb * bbsize;

      $('r_bankroll').textContent = formatTHB(bankroll_ccy);
      $('r_unit').textContent = 'บาท';
      $('r_limit').textContent = `${Math.round(bankroll_bb)} BB (~${formatTHB(bankroll_ccy)} ฿)`;
      const safety = ror<=0.001 ? 'ปลอดภัยมาก' : ror<=0.01 ? 'ปลอดภัย' : ror<=0.05 ? 'มาตรฐาน' : 'ค่อนข้างเสี่ยง';
      $('r_safety').textContent = safety;
      $('explain').textContent = `คำนวณจาก Risk of Ruin = ${(ror*100).toFixed(2)}%, winrate ${wr100} bb/100, σ ${sd100} bb/100 โดยผลลัพธ์คือแบงค์โรลขั้นต่ำที่ลดโอกาสล้มละลายตามที่กำหนด`;
    });

    // SNG
    $('calc_sng').addEventListener('click', ()=>{
      const abi = parseFloat($('sng_abi').value);
      const roi = parseFloat($('sng_roi').value);
      const risk= parseFloat($('sng_risk').value);
      const base= parseFloat($('sng_type').value);
      const ccy = parseFloat($('sng_ccy').value);
      if(abi<=0 || ccy<=0){ alert('กรุณาใส่ค่า ABI และค่าเงินมากกว่า 0'); return; }

      // ROI adjustment: higher ROI reduces requirement a bit; low ROI increases.
      let adj = 1.0;
      if(roi >= 15) adj = 0.85;
      if(roi >= 25) adj = 0.75;
      if(roi <= 8) adj = 1.15;
      if(roi <= 4) adj = 1.3;

      const abi_mult = base * adj * risk;
      const bankroll = abi * abi_mult * ccy;

      $('r_bankroll').textContent = formatTHB(bankroll);
      $('r_unit').textContent = 'บาท';
      $('r_limit').textContent = `${Math.round(abi_mult)} × ABI`;
      $('r_safety').textContent = risk<=0.75 ? 'เชิงรุก' : risk>=1.3 ? 'ระมัดระวัง' : 'มาตรฐาน';
      $('explain').textContent = `เลือกฐาน ${base}× ABI ปรับตาม ROI (${roi}%) และระดับความเสี่ยง เพื่อสะท้อน variance ของ SNG แต่ละโครงสร้าง`;
    });

    // MTT
    $('calc_mtt').addEventListener('click', ()=>{
      const abi = parseFloat($('mtt_abi').value);
      const roi = parseFloat($('mtt_roi').value);
      const risk= parseFloat($('mtt_risk').value);
      const field = parseFloat($('mtt_field').value);
      const ccy = parseFloat($('mtt_ccy').value);
      if(abi<=0 || ccy<=0){ alert('กรุณาใส่ค่า ABI และค่าเงินมากกว่า 0'); return; }

      // ROI adjustment: bigger ROI reduces requirement; small ROI increases
      let adj = 1.0;
      if(roi >= 30) adj = 0.7;
      else if(roi >= 20) adj = 0.8;
      else if(roi <= 10) adj = 1.25;

      const abi_mult = Math.round(field * adj * risk);
      const bankroll = abi * abi_mult * ccy;

      $('r_bankroll').textContent = formatTHB(bankroll);
      $('r_unit').textContent = 'บาท';
      $('r_limit').textContent = `${abi_mult} × ABI`;
      $('r_safety').textContent = risk<=0.7 ? 'เชิงรุก' : risk>=1.4 ? 'ระมัดระวัง' : 'มาตรฐาน';
      $('explain').textContent = `MTT variance สูงขึ้นตามขนาดฟิลด์: ฐาน ${field}× ABI ปรับด้วย ROI (${roi}%) และระดับความเสี่ยง`;
    });

    $('reset').addEventListener('click', ()=>{
      document.querySelectorAll('input').forEach(i=>{ if(i.type==='number'){ /* keep defaults */ } });
      clearResult();
    });
  </script>
</body>
</html>
